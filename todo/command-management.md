# ã‚³ãƒãƒ³ãƒ‰ç®¡ç† è¦ä»¶å®šç¾©

## æ¦‚è¦
ã‚³ãƒãƒ³ãƒ‰å±¥æ­´ã®å­¦ç¿’ï¼ˆé »åº¦ãƒ»æœ€è¿‘ä½¿ç”¨ï¼‰ã¨ãŠæ°—ã«å…¥ã‚Šç™»éŒ²æ©Ÿèƒ½

---

## æ©Ÿèƒ½è¦ä»¶

### FR-1: ã‚³ãƒãƒ³ãƒ‰å±¥æ­´è¨˜éŒ²
- [ ] ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã‚’è¨˜éŒ²
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«åˆ†ã‘ã¦ç®¡ç†
- [ ] è¨˜éŒ²ãƒ‡ãƒ¼ã‚¿:
  - ã‚³ãƒãƒ³ãƒ‰æ–‡å­—åˆ—
  - å®Ÿè¡Œå›æ•°ï¼ˆé »åº¦ï¼‰
  - æœ€çµ‚å®Ÿè¡Œæ—¥æ™‚
  - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‘ã‚¹

### FR-2: ã‚³ãƒãƒ³ãƒ‰å­¦ç¿’ãƒ»ãƒ©ãƒ³ã‚­ãƒ³ã‚°
- [ ] å®Ÿè¡Œé »åº¦ã§ã‚½ãƒ¼ãƒˆè¡¨ç¤º
- [ ] æœ€è¿‘ä½¿ã£ãŸé †ã§ã‚‚ã‚½ãƒ¼ãƒˆå¯èƒ½
- [ ] è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆã‚¿ãƒ– or ãƒˆã‚°ãƒ«

### FR-3: ãŠæ°—ã«å…¥ã‚Šç™»éŒ²
- [ ] å±¥æ­´ä¸€è¦§ã®å„ã‚³ãƒãƒ³ãƒ‰ã«â˜†ãƒœã‚¿ãƒ³é…ç½®
- [ ] ã‚¯ãƒªãƒƒã‚¯ã§ãŠæ°—ã«å…¥ã‚Šç™»éŒ²/è§£é™¤
- [ ] ãŠæ°—ã«å…¥ã‚Šã¯åˆ¥ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è¡¨ç¤º
- [ ] ãŠæ°—ã«å…¥ã‚Šã¯å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…±é€š

### FR-4: ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
- [ ] å±¥æ­´/ãŠæ°—ã«å…¥ã‚Šã‹ã‚‰ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯å®Ÿè¡Œ
- [ ] ç¾åœ¨ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã„ã‚‹ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œ
- [ ] å®Ÿè¡Œå¾Œã€å±¥æ­´ã«å†è¨˜éŒ²ï¼ˆé »åº¦ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ï¼‰

### FR-5: å±¥æ­´UIè¡¨ç¤º
- [ ] ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¾ãŸã¯å°‚ç”¨ãƒ‘ãƒãƒ«ã«å±¥æ­´è¡¨ç¤º
- [ ] è¡¨ç¤ºãƒˆãƒªã‚¬ãƒ¼: ãƒœã‚¿ãƒ³ or ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
- [ ] æ¤œç´¢/ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½

---

## éæ©Ÿèƒ½è¦ä»¶

### NFR-1: ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
- [ ] JSONãƒ•ã‚¡ã‚¤ãƒ«ã§ä¿å­˜
- [ ] ä¿å­˜å…ˆ: `~/.claudeck/commands.json`
- [ ] ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«èª­ã¿è¾¼ã¿
- [ ] å¤‰æ›´æ™‚ã«è‡ªå‹•ä¿å­˜ï¼ˆãƒ‡ãƒã‚¦ãƒ³ã‚¹ï¼‰

### NFR-2: å±¥æ­´ä¸Šé™
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«æœ€å¤§500ä»¶
- [ ] å¤ã„ãƒ»é »åº¦ä½ã„ã‚‚ã®ã‹ã‚‰è‡ªå‹•å‰Šé™¤

### NFR-3: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- [ ] å±¥æ­´è¡¨ç¤ºã¯100msä»¥å†…
- [ ] ä¿å­˜ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§éåŒæœŸ

---

## æŠ€è¡“è¨­è¨ˆ

### æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«
| ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ |
|---------|------|
| `src/components/CommandHistory.tsx` | å±¥æ­´è¡¨ç¤ºUI |
| `src/stores/commandStore.ts` | ã‚³ãƒãƒ³ãƒ‰çŠ¶æ…‹ç®¡ç†ï¼ˆZustandï¼‰ |
| `electron/services/commandStorage.ts` | JSONèª­ã¿æ›¸ã |

### å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«
| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´å†…å®¹ |
|---------|---------|
| `electron/main.ts` | IPCè¿½åŠ  |
| `electron/preload.ts` | APIè¿½åŠ  |
| `src/components/Layout.tsx` | CommandHistoryé…ç½® |
| `src/components/XtermWrapper.tsx` | ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ¤œå‡º |

### IPCè¨­è¨ˆ
```typescript
// æ–°è¦IPC
'commands:load' â†’ CommandData[]
'commands:save' â†’ void
'commands:add' â†’ void (command, projectPath)
'commands:favorite' â†’ void (command, isFavorite)
```

### ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
```typescript
interface CommandEntry {
  command: string;
  count: number;          // å®Ÿè¡Œå›æ•°
  lastUsed: number;       // Unix timestamp
  projectPath: string;
  isFavorite: boolean;
}

interface CommandData {
  version: 1;
  entries: CommandEntry[];
}

// Zustand Store
interface CommandState {
  entries: CommandEntry[];
  favorites: CommandEntry[];
  addCommand: (cmd: string, project: string) => void;
  toggleFavorite: (cmd: string) => void;
  getByProject: (project: string) => CommandEntry[];
  getByFrequency: (project: string) => CommandEntry[];
  getByRecent: (project: string) => CommandEntry[];
}
```

### ã‚³ãƒãƒ³ãƒ‰æ¤œå‡ºãƒ­ã‚¸ãƒƒã‚¯
```typescript
// PTYå‡ºåŠ›ã‹ã‚‰ã‚³ãƒãƒ³ãƒ‰ã‚’æ¤œå‡º
// æ–¹æ³•1: OSC 133ï¼ˆã‚·ã‚§ãƒ«çµ±åˆï¼‰ã‚’åˆ©ç”¨
// æ–¹æ³•2: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå¾Œã®å…¥åŠ›ã‚’ç›£è¦–
// æ–¹æ³•3: Enterã‚­ãƒ¼æŠ¼ä¸‹æ™‚ã®å…¥åŠ›ãƒãƒƒãƒ•ã‚¡ã‚’è¨˜éŒ²

// æ¨å¥¨: Enterã‚­ãƒ¼æŠ¼ä¸‹æ™‚ã«å…¥åŠ›è¡Œã‚’å–å¾—
onKeyPress((key) => {
  if (key === '\r') {  // Enter
    const command = getCurrentInputLine();
    recordCommand(command);
  }
});
```

---

## UIè¨­è¨ˆ

### å±¥æ­´ãƒ‘ãƒãƒ«
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚³ãƒãƒ³ãƒ‰å±¥æ­´          [é »åº¦|æœ€è¿‘]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜… ãŠæ°—ã«å…¥ã‚Š                        â”‚
â”‚   â˜† git status                      â”‚
â”‚   â˜… npm run dev                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š ã‚ˆãä½¿ã†                         â”‚
â”‚   â˜† git add .         (32å›)        â”‚
â”‚   â˜† git commit        (28å›)        â”‚
â”‚   â˜† npm test          (15å›)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ• æœ€è¿‘                             â”‚
â”‚   â˜† ls -la            2åˆ†å‰         â”‚
â”‚   â˜† cd src            5åˆ†å‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼
```json
{
  "version": 1,
  "entries": [
    {
      "command": "git status",
      "count": 32,
      "lastUsed": 1705123456789,
      "projectPath": "/Users/user/project",
      "isFavorite": true
    }
  ]
}
```

---

## ãƒ†ã‚¹ãƒˆé …ç›®
- [ ] ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ã«å±¥æ­´ã«è¨˜éŒ²ã•ã‚Œã‚‹ã“ã¨
- [ ] é »åº¦é †ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã‚‹ã“ã¨
- [ ] æœ€è¿‘ä½¿ã£ãŸé †ã§ã‚½ãƒ¼ãƒˆã•ã‚Œã‚‹ã“ã¨
- [ ] ãŠæ°—ã«å…¥ã‚Šç™»éŒ²/è§£é™¤ãŒã§ãã‚‹ã“ã¨
- [ ] å±¥æ­´ã‹ã‚‰ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯å®Ÿè¡Œã§ãã‚‹ã“ã¨
- [ ] JSONãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã‚‹ã“ã¨
- [ ] ã‚¢ãƒ—ãƒªå†èµ·å‹•å¾Œã‚‚å±¥æ­´ãŒæ®‹ã‚‹ã“ã¨

---

## å„ªå…ˆåº¦
**ä¸­** - åˆ©ä¾¿æ€§å‘ä¸Šæ©Ÿèƒ½

## ä¾å­˜é–¢ä¿‚
- ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã®åŸºç›¤å®Ÿè£…ãŒå¿…è¦
