# ショートカットオーバーレイ 要件定義

## 概要
キーボードショートカット一覧をオーバーレイで表示する機能

---

## 機能要件

### FR-1: オーバーレイ表示
- [ ] `Cmd + .` または `Cmd + ;` で表示/非表示切り替え
- [ ] 同じショートカットで閉じる（トグル動作）
- [ ] ESCキーでも閉じる
- [ ] 背景クリックでも閉じる

### FR-2: ショートカット一覧表示
- [ ] カテゴリ別にグループ化して表示
- [ ] ショートカットキー + 説明 の形式
- [ ] 視認性の高いレイアウト

### FR-3: カテゴリ
- [ ] **アプリ全体**: ウィンドウ操作、パレット呼び出しなど
- [ ] **ターミナル**: コピー、ペースト、クリアなど
- [ ] **Claudeck機能**: Claude起動、script実行など

### FR-4: 半透明オーバーレイ
- [ ] 背景を半透明でターミナルが見える状態
- [ ] 中央に一覧カードを配置
- [ ] スクロール可能（ショートカットが多い場合）

---

## 非機能要件

### NFR-1: UI/UX
- [ ] フェードイン/アウトアニメーション
- [ ] ダークテーマに合ったデザイン
- [ ] モバイル風のカード形式

### NFR-2: パフォーマンス
- [ ] 表示まで50ms以内
- [ ] ショートカット押下時のレスポンス即時

### NFR-3: 拡張性
- [ ] ショートカット定義をconfig化
- [ ] 新機能追加時に簡単に追加できる構造

---

## 技術設計

### 新規ファイル
| ファイル | 内容 |
|---------|------|
| `src/components/ShortcutOverlay.tsx` | オーバーレイUI |
| `src/config/shortcuts.ts` | ショートカット定義 |

### 変更ファイル
| ファイル | 変更内容 |
|---------|---------|
| `src/App.tsx` | グローバルキーイベント追加 |
| `src/components/Layout.tsx` | ShortcutOverlay配置 |
| `src/index.css` | オーバーレイスタイル |

### データ構造
```typescript
interface Shortcut {
  keys: string;          // "Cmd + K"
  description: string;   // "コマンドパレットを開く"
  category: ShortcutCategory;
}

type ShortcutCategory = 'app' | 'terminal' | 'claudeck';

const SHORTCUTS: Shortcut[] = [
  { keys: 'Cmd + K', description: 'コマンドパレットを開く', category: 'app' },
  { keys: 'Cmd + .', description: 'ショートカット一覧', category: 'app' },
  // ...
];
```

### キーイベント処理
```typescript
useEffect(() => {
  const handleKeyDown = (e: KeyboardEvent) => {
    // Cmd + . または Cmd + ;
    if (e.metaKey && (e.key === '.' || e.key === ';')) {
      e.preventDefault();
      toggleOverlay();
    }
    // ESC で閉じる
    if (e.key === 'Escape' && isOpen) {
      closeOverlay();
    }
  };

  window.addEventListener('keydown', handleKeyDown);
  return () => window.removeEventListener('keydown', handleKeyDown);
}, [isOpen]);
```

---

## UI設計

```
┌─────────────────────────────────────────────────────────┐
│                    (半透明背景)                          │
│   ┌───────────────────────────────────────────────┐     │
│   │           ⌨️ キーボードショートカット            │     │
│   ├───────────────────────────────────────────────┤     │
│   │ 📱 アプリ全体                                  │     │
│   │   Cmd + K      コマンドパレットを開く          │     │
│   │   Cmd + .      ショートカット一覧              │     │
│   │   Cmd + W      ウィンドウを閉じる              │     │
│   ├───────────────────────────────────────────────┤     │
│   │ 💻 ターミナル                                  │     │
│   │   Cmd + C      コピー                          │     │
│   │   Cmd + V      ペースト                        │     │
│   │   Cmd + L      クリア                          │     │
│   │   Ctrl + C     実行中止                        │     │
│   ├───────────────────────────────────────────────┤     │
│   │ ✨ Claudeck                                    │     │
│   │   Cmd + Enter  Claude起動                      │     │
│   │   Cmd + H      履歴表示                        │     │
│   └───────────────────────────────────────────────┘     │
└─────────────────────────────────────────────────────────┘
```

---

## ショートカット一覧（初期定義）

### アプリ全体
| キー | 説明 |
|------|------|
| `Cmd + K` | コマンドパレットを開く |
| `Cmd + .` | ショートカット一覧 |
| `Cmd + ,` | 設定（将来） |
| `Cmd + Q` | アプリを終了 |
| `Cmd + W` | ウィンドウを閉じる |

### ターミナル
| キー | 説明 |
|------|------|
| `Cmd + C` | コピー |
| `Cmd + V` | ペースト |
| `Cmd + L` | 画面クリア |
| `Ctrl + C` | 実行中止 |
| `Ctrl + D` | 終了 |
| `↑` / `↓` | 履歴移動 |

### Claudeck
| キー | 説明 |
|------|------|
| `Cmd + Enter` | Claude起動（要検討） |
| `Cmd + H` | コマンド履歴（要検討） |
| `Cmd + 1-4` | ペイン切り替え |

---

## テスト項目
- [ ] Cmd + . でオーバーレイが表示されること
- [ ] Cmd + ; でもオーバーレイが表示されること
- [ ] 同じキーで閉じること（トグル）
- [ ] ESCで閉じること
- [ ] 背景クリックで閉じること
- [ ] カテゴリ別に表示されること
- [ ] アニメーションがスムーズであること

---

## 優先度
**低〜中** - あると便利だが必須ではない

## 依存関係
- ショートカット自体の実装が先（各機能完成後にまとめて表示）
